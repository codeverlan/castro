# Database Configuration
# Copy this file to .env and fill in your values

# PostgreSQL connection settings
# For local Supabase development, you may need to connect via a port forwarder
# to the supabase-db container on port 54322 (or your configured port)
DATABASE_HOST=localhost
DATABASE_PORT=5432
DATABASE_USER=postgres
DATABASE_PASSWORD=your_password_here
DATABASE_NAME=castro

# For Supabase local development:
# DATABASE_PORT=54322
# DATABASE_USER=supabase_admin
# DATABASE_PASSWORD=<your_supabase_admin_password>

# Connection pool settings
DATABASE_POOL_MAX=10
DATABASE_IDLE_TIMEOUT=30000
DATABASE_CONNECTION_TIMEOUT=2000

# SSL mode (set to 'true' for production)
DATABASE_SSL=false

# Ollama Configuration
# Local Ollama server URL
OLLAMA_BASE_URL=http://localhost:11434

# Default model for general operations (llama3, llama3.1, llama3.2, mistral, mistral-nemo)
OLLAMA_DEFAULT_MODEL=llama3

# Fallback model if default is unavailable
OLLAMA_FALLBACK_MODEL=mistral

# Request timeout in milliseconds (default: 120000 = 2 minutes)
OLLAMA_TIMEOUT=120000

# Maximum retry attempts for failed requests
OLLAMA_MAX_RETRIES=3

# Delay between retries in milliseconds
OLLAMA_RETRY_DELAY=1000

# Default temperature for generation (0-2, lower = more deterministic)
OLLAMA_DEFAULT_TEMPERATURE=0.7

# Default max tokens for generation
OLLAMA_DEFAULT_MAX_TOKENS=2048

# Keep model loaded in memory (e.g., "5m", "1h", "-1" for indefinite)
OLLAMA_KEEP_ALIVE=5m

# Whisper.cpp Configuration
# Path to whisper.cpp executable (whisper-cli or main binary)
# If installed via Homebrew on macOS: /opt/homebrew/bin/whisper
# If built from source: /path/to/whisper.cpp/main
WHISPER_EXECUTABLE_PATH=whisper

# Path to directory containing Whisper model files (ggml-*.bin)
WHISPER_MODELS_PATH=/usr/local/share/whisper/models

# Default model for transcription (tiny, base, small, medium, large, large-v2, large-v3)
# Recommended: base for speed/quality balance, small for better accuracy
WHISPER_DEFAULT_MODEL=base

# Fallback model if default is unavailable
WHISPER_FALLBACK_MODEL=tiny

# Transcription timeout in milliseconds (default: 600000 = 10 minutes)
# Long audio files may need more time
WHISPER_TIMEOUT=600000

# Maximum retry attempts for failed transcriptions
WHISPER_MAX_RETRIES=3

# Delay between retries in milliseconds
WHISPER_RETRY_DELAY=2000

# Default number of threads (0 = auto-detect, recommended: number of CPU cores)
WHISPER_DEFAULT_THREADS=4

# Default number of processors (usually 1)
WHISPER_DEFAULT_PROCESSORS=1

# Default language (empty for auto-detection, or ISO 639-1 code like 'en', 'es', 'fr')
WHISPER_DEFAULT_LANGUAGE=

# Enable word-level timestamps (true/false)
WHISPER_ENABLE_WORD_TIMESTAMPS=false

# Queue processing: poll interval in milliseconds
WHISPER_QUEUE_POLL_INTERVAL=5000

# Queue processing: lock duration in milliseconds (how long a job is locked before timeout)
WHISPER_QUEUE_LOCK_DURATION=300000

# Queue processing: maximum concurrent transcription jobs
WHISPER_QUEUE_MAX_CONCURRENT=1

# Temporary directory for audio processing
WHISPER_TEMP_DIRECTORY=/tmp/whisper

# File Watcher Configuration
# Path to watch for new audio files (absolute or relative to project root)
FILE_WATCHER_PATH=./audio-inbox

# Whether file watcher is enabled (true/false)
FILE_WATCHER_ENABLED=true

# Supported file extensions (comma-separated, with leading dot)
FILE_WATCHER_EXTENSIONS=.mp3,.wav,.m4a,.ogg,.webm

# Use polling mode (required for network drives or Docker volumes)
FILE_WATCHER_USE_POLLING=false

# Polling interval in milliseconds (only used if USE_POLLING=true)
FILE_WATCHER_POLL_INTERVAL=1000

# Time to wait for file write to stabilize before processing (in milliseconds)
FILE_WATCHER_STABILITY_THRESHOLD=2000

# Poll interval while waiting for file write to finish (in milliseconds)
FILE_WATCHER_STABILITY_POLL_INTERVAL=100

# Patterns to ignore (comma-separated glob patterns)
FILE_WATCHER_IGNORED_PATTERNS=**/.*,**/*.tmp,**/*.part,**/~*,**/*.crdownload

# Process existing files when watcher starts (true/false)
FILE_WATCHER_PROCESS_EXISTING=true

# Default template ID for new sessions (leave empty to use most recent active template)
FILE_WATCHER_DEFAULT_TEMPLATE_ID=

# Maximum file size to process in bytes (0 = no limit, default: 500MB)
FILE_WATCHER_MAX_FILE_SIZE=524288000

# Minimum file size to process in bytes (default: 1KB, to skip incomplete files)
FILE_WATCHER_MIN_FILE_SIZE=1024
